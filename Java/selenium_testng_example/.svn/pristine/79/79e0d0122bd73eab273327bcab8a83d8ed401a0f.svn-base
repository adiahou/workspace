package dxy.vs.testcase.exam;

import org.openqa.selenium.support.PageFactory;
import org.testng.annotations.Test;

import dxy.vs.base.ReusableFunctions;
import dxy.vs.base.SetUp;
import dxy.vs.pages.CMS_ManageContentPage;
import dxy.vs.pages.Exam_ManageModePage;
import dxy.vs.pages.Exam_ManageQuestionPage;
import dxy.vs.pages.Exam_ScorePage;
import dxy.vs.pages.Front_Demo1Page;

public class F_01_3_manageVote extends SetUp{
	
	//Initialize Pages
	ReusableFunctions reusableFunctions;
	Exam_ManageModePage manageModePage;
	Exam_ManageQuestionPage manageQuestionPage;
	CMS_ManageContentPage manageContentPage;
	Front_Demo1Page demo1Page;
	Exam_ScorePage scorePage;
	
	String voteUrl="";
	
	@Test
	public void newVote() throws Exception{
		reusableFunctions= PageFactory.initElements(threadDriver.get(), ReusableFunctions.class);
		manageModePage= PageFactory.initElements(threadDriver.get(), Exam_ManageModePage.class);
		manageQuestionPage= PageFactory.initElements(threadDriver.get(), Exam_ManageQuestionPage.class);
		manageContentPage= PageFactory.initElements(threadDriver.get(), CMS_ManageContentPage.class);
		demo1Page= PageFactory.initElements(threadDriver.get(), Front_Demo1Page.class);
		scorePage= PageFactory.initElements(threadDriver.get(), Exam_ScorePage.class);
		
		reusableFunctions.enterVS(0);
		
		manageModePage.openManageExamPage();
		manageModePage.clearOldData();
		String surveyTitle=manageModePage.createExam("投票");
		
		manageQuestionPage.openManageQuestionPage();
		manageQuestionPage.clearOldData();
		manageQuestionPage.creatQuestion_selection("单选", true, null,"1",false,false);
		manageQuestionPage.creatQuestion_selection("单选", false, null,"2",true,false);
		manageQuestionPage.creatQuestion_selection("多选", true, null,"3",false,false);
		manageQuestionPage.creatQuestion_selection("多选", false, null,"4",true,true);
		manageQuestionPage.creatQuestion_dropdown(false, null, "5", false);
		manageQuestionPage.creatQuestion_dropdown(true, null, "6", true);
		manageQuestionPage.creatQuestion_input(true, "中文文本", "7", false);
		manageQuestionPage.creatQuestion_input(false, "数字文本", "8", false);
		manageQuestionPage.creatQuestion_input(true, "医院", "9", false);
		manageQuestionPage.creatQuestion_input(false, "科室", "10", false);
		manageQuestionPage.creatQuestion_input(true, "邮箱", "11", false);
		manageQuestionPage.creatQuestion_input(false, "电话", "12", false);
		manageQuestionPage.creatQuestion_input(true, "自由文本", "13", false);
		
		manageContentPage.openContentManagePage();
		manageContentPage.clearOldData();
		voteUrl = manageContentPage.newExamContent(surveyTitle);
		demo1Page.verifyExam(voteUrl, true, false, true,true,true,true);
	}
	
	@Test
	(dependsOnMethods = {"newVote"})
	public void updateVote() throws Exception{
		reusableFunctions= PageFactory.initElements(threadDriver.get(), ReusableFunctions.class);
		manageModePage= PageFactory.initElements(threadDriver.get(), Exam_ManageModePage.class);
		demo1Page= PageFactory.initElements(threadDriver.get(), Front_Demo1Page.class);
		
		reusableFunctions.enterVS(0);
		
		manageModePage.openManageExamPage();
		manageModePage.updateExam(false,false,false,true,false);
		
		demo1Page.verifyExam(voteUrl, false, false, false,true,true,false);
	}
	
	@Test
	(dependsOnMethods = {"updateVote"})
	public void disableVote() throws Exception{
		reusableFunctions= PageFactory.initElements(threadDriver.get(), ReusableFunctions.class);
		manageModePage= PageFactory.initElements(threadDriver.get(), Exam_ManageModePage.class);
		demo1Page= PageFactory.initElements(threadDriver.get(), Front_Demo1Page.class);
		
		reusableFunctions.enterVS(0);
		
		manageModePage.openManageExamPage();
		manageModePage.updateExam(false,false,false,false,false);
		
		demo1Page.verifyExam(voteUrl, false, false, false, false,true,false);
	}
	
	
	@Test
	(dependsOnMethods = {"disableVote"})
	public void deleteVote() throws Exception{
		reusableFunctions= PageFactory.initElements(threadDriver.get(), ReusableFunctions.class);
		manageModePage= PageFactory.initElements(threadDriver.get(), Exam_ManageModePage.class);
		manageQuestionPage= PageFactory.initElements(threadDriver.get(), Exam_ManageQuestionPage.class);
		manageContentPage= PageFactory.initElements(threadDriver.get(), CMS_ManageContentPage.class);
		
		reusableFunctions.enterVS(0);
		manageModePage.openManageExamPage();
		manageModePage.clearOldData();
		
		manageQuestionPage.openManageQuestionPage();
		manageQuestionPage.clearOldData();
		
		manageContentPage.openContentManagePage();
		manageContentPage.clearOldData();
	}
	
}
